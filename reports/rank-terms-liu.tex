% Preamble
\documentclass[11pt,reqno,oneside,a4paper]{article}
\usepackage[a4paper,includeheadfoot,left=25mm,right=25mm,top=00mm,bottom=20mm,headheight=20mm]{geometry}
\input{../texhead-main} % Standard packages, page layout, theorem environments, macros, etc
\input{../texhead-project} % Macros specific to this project.
\author{Zhang Liu}
\title{Rank Terms}
\renewcommand{\runningtitle}{Rank Terms}
\date{\today}

\begin{document}
\maketitle
\thispagestyle{fancy}

\begin{abstract}
	The aim of this part of the project is to rank the relative importance of the terms in the exponential sum. We have explained in this document both the geometric method and the algebraic method. We have then shown that the two methods are equivalent.  
\end{abstract}

% \tableofcontents

\section{The Geometric Method} \label{sec:geom}
	Given $e^{a_i z}$, an arbitrary term in the exponential sum, we obtain $e^{\overline{a_i}z}$, where $\overline{a_i}$ is the complex conjugate of $a_i$. We can then write $\overline{a_i},z$ in their respective polar forms:
	$$\overline{a_i} = p_i (\cos\alpha_i + i\sin\alpha_i),$$
	$$z = b (\cos\beta_i + i\sin\beta_i).$$ 
	The inner product of $\overline{a_i}$ with the direction of $z$ is:
	$$
	\langle \overline{a_i}, \frac{z}{\abs{z}} \rangle = p_i \cos(\alpha_i - \beta).
	$$
	
	Now, suppose that the convex hull has been constructed. To rank the terms efficiently, we follow the steps below:
	\begin{enumerate}
		\item Using the direction of $z$ and $l$ perpendicular to $z$, partition the plane into four regions according to the sign of $\cos(\alpha_i - \beta).$
		
	(insert figure here)
		
		\item Calculate the respective inner product in the direction of $z$, for each term in the exponential sum, i.e., $	\langle \overline{a_i}, \frac{z}{\abs{z}} \rangle.$
		
		Then the rank of $	\langle \overline{a_i}, \frac{z}{\abs{z}} \rangle$ corresponds to the rank of terms. In other words, for any two terms, $e^{iz}$ and $e^{jz}$, if $	\langle \overline{a_i}, \frac{z}{\abs{z}} \rangle > 	\langle \overline{a_j}, \frac{z}{\abs{z}} \rangle$. then $e^{a_iz}>e^{a_jz}.$
		  
	\end{enumerate}
\section{The Algebraic Method}\label{sec:alg} 


\subsection{The Collinear Case}\label{subsec:algcol}

In this section, we apply the algebraic method under the collinear case where we are given $e^{az}+a^{bz} + a^{cz}, a\neq b \neq c, a,b,c \in \mathbb{C}, a,b,c$ are collinear. 

Calculating the ratio of terms pairwise, we get:
$$R_1 = \abs{\frac{e^{cz}}{e^{az}}} = \abs{e^{(c-a)z}},$$
$$R_2 = \abs{\frac{e^{bz}}{e^{az}}} = \abs{e^{(b-a)z}},$$
$$R_3 = \abs{\frac{e^{bz}}{e^{cz}}} = \abs{e^{(b-c)z}}.$$

Note that without loss of generality, we suppose that $c$ lies on the segment $(a,b), i.e.,$

(insert figure)

Now, let $\alpha_1 = \arg(c-a), \alpha_2 = \arg(b-a), \alpha_3 = \arg(b-c).$

Since $a,b,c$ are collinear,
\begin{align*}
&\frac{c-a}{b-a} = \lambda, \lambda \in \mathbb{R}\\
\implies &\frac{r_1 e^{i\alpha_1}}{r_2 e^{i\alpha_2}} = \lambda \\
\implies &\frac{r_1}{r_2} e^{i(\alpha_1 - \alpha_2)} = \lambda.
\end{align*}
Since $\lambda\in\mathbb{R}, \alpha_1 - \alpha_2 = 0 \implies \alpha_1 = \alpha_2.$

By a similar argument, $\alpha_3 = \alpha_1 = \alpha_2.$

Thus, given that $a,b,c\in \mathbb{C}$ collinear, we can first compute any one of the $\arg(c-a),\arg(b-a),\arg(b-c)$ and note the result as $\alpha.$

Then, when $-\frac{\pi}{2} -\alpha < \theta < \frac{\pi}{2} - \alpha$, 
\begin{align*}
&e^{bz} > e^{az}, \\
&e^{bz} > e^{cz}, \\
&e^{cz} > e^{az}, \\
\implies &e^{bz} \text{ dominates.}
\end{align*}

Otherwise, 
\begin{align*}
&e^{bz} < e^{az}, \\
&e^{bz} < e^{cz}, \\
&e^{cz} < e^{az}, \\
\implies &e^{az} \text{ dominates.}
\end{align*}
 
\subsection{The Non-Collinear Case}\label{subsec:algnoncol}

In this section, we apply the algebraic method under the non-collinear case where we are given $e^{az}+a^{bz} + a^{cz}, a\neq b \neq c, a,b,c \in \mathbb{C}, a,b,c$ are not collinear.

Without loss of generality, we label the points $a,b,c$ in counter-clockwise direction. 

Let 
$$\alpha_1 = \arg(b-a) \text{ (the angle from a to b)},$$
$$\alpha_2 = \arg(c-b) \text{ (the angle from b to c)},$$
$$\alpha_3 = \arg(a-c) \text{ (the angle from c to a)}.$$
Since $a,b,c$ are not collinear, $\alpha_1 \neq \alpha_2 \neq \alpha_3.$

From the workings in the collinear case, we get:
\begin{itemize}
	\item When $\theta \in I_1 = \left(-\frac{\pi}{2} - \alpha_1, \frac{\pi}{2}-\alpha_1\right), e^{bz}>e^{az}.$
	Otherwise (i.e., when $\theta \in (-\pi,\pi)\ I_1), e^{bz}<e^{az}.$
	
	\item When $\theta \in I_2 = \left(-\frac{\pi}{2} - \alpha_2, \frac{\pi}{2}-\alpha_2\right), e^{cz}>e^{bz}.$
	Otherwise (i.e., when $\theta \in (-\pi,\pi)\ I_2),  e^{cz}<e^{bz}.$
	
	\item When $\theta \in I_3 = \left(-\frac{\pi}{2} - \alpha_3, \frac{\pi}{2}-\alpha_3\right), e^{az}>e^{cz}.$
	Otherwise (i.e., when $\theta \in (-\pi,\pi)\ I_3),  e^{az}<e^{cz}.$
\end{itemize}

Overall, 
\begin{itemize}
	\item when $\theta \in I_1 \cap \left((-\pi,\pi) \ (I_2\cup I_3)\right), e^{bz}$ dominates,
	\item when $\theta \in I_2 \cap \left((-\pi,\pi) \ (I_1\cup I_3)\right), e^{cz}$ dominates,
	\item when $\theta \in I_3 \cap \left((-\pi,\pi) \ (I_1	\cup I_2)\right), e^{az}$ dominates.
\end{itemize}

\subsection{The General Case}\label{subsec:alggen}

In this section, we apply the algebraic method under the most general case where we are given an exponential sum of the general form, $f(z) = \sum_{k=1}^{n}e^{a_k z}, a_k \in \mathbb{C}$. The algebraic method consists of the following steps:

\begin{enumerate}
	\item Given the set of exponents $\{a_k\}$, find the set of their respective complex conjugates $\{\overline{a_k}\}$.
	\item Construct the convex hull to get the set $\{l_r\},$ where $r = 1,\dots,q.$
	\item Calculate $\alpha_r$ and hence $I_r$.
	\item Determine which side the dominant term is located:
	If $\theta \in I_i \cap \left((-\pi,pi)\ \bigcap_{r=1}^{r=q,r\neq i}I_r \right),$ then the dominant term is on the side $I_{i+1}$ if $i = 1,\dots,q-1$ and on the side $I_1$ if $i = q$.
	\item Having obtained the side $l_R$ from the previous step, determine which term on the side $l_R$ is dominant:
	If $-\frac{\pi}{2} - \alpha_R < \theta < \frac{\pi}{2} - \alpha_R,$  then $c_{R1}$ dominates. Otherwise, $c_{R h_R}$ dominates.
\end{enumerate}

We now provides details on the above steps. 

Given a set of exponents $\{a_k\}$ where each $a_k \in \mathbb{C},$ we can reflect each point about the $x$-axis to form the set of their respective complex conjugates, i.e., for $A =\{a_1,\dots,a_n\}$, we obtain $A^\prime = \{\overline{a_1}, \dots, \overline{a_n}\}$. 

For the set $A^\prime = \{\overline{a_1}, \dots, \overline{a_n}\}$, we can construct a convex hull by dividing $A^\prime$ into two sets:

\begin{enumerate}
	\item The points that lie on the perimeter of the convex hull, $l_r = \{c_{rh}\mid h = 1,2,\dots, h_r\}$, where $h_r$ is the total number of points on the side $l_r$, specifically:
	$$l_1 = \{c_{1 1}, c_{1 2}, \dots, c_{1 h_1} \} (h_1 \text{ points on } l_1),$$
	$$l_2 = \{c_{2 1}, c_{2 2}, \dots, c_{2 h_1} \} (h_2 \text{ points on } l_2),$$
	$$\cdots$$
	$$l_q = \{c_{q 1}, c_{q 2}, \dots, c_{q h_1} \} (h_q \text{ points on } l_q).$$
	\item The points that lie within the interior of the convex hull. 
\end{enumerate}

\par We use the first set of points (those that lie on the perimeter) to determine the dominance of terms. Note that the points and sides are both labeled in counter-clockwise direction, i.e.,

(insert figure)

\par First, we determine on which side can we find the dominant term. To do this, we choose, without loss of generality, $c_{r 1}$ as the ``representative" point for the side $l_r$ for each $r=1,2,\dots,q$. Then the non-collinear case applies. 

\par For $r = 1,2,\dots,q-1$, let 
$$\alpha_r = \arg(c_{r+1 1} - c_{r 1}),$$
$$\alpha_q = \arg(c_{1 1} - c_{q 1}).$$

Since $c_{1 1}, c_{2 1}, \dots, c_{q 1}$ are not collinear, $\alpha_i \neq \alpha_j$ whenever $i\neq j,$ i.e., the arguments are pairwise different.  

Let the internal $I_r = \left(-\frac{\pi}{2} - \alpha_r, \frac{\pi}{2} - \alpha_r\right)$ for each $\alpha_r$ respectively. 

Now, generating the results from the non-collinear case (insert ref), we get:

if $\theta\in I_i \cap \left((-\pi, \pi) \ \bigcap_{r=1}^{r=q,r\neq i} I_r\right),$ then the dominant term is on the side  $I_{i+1}$ if $i = 1,\dots,q-1$ and on the side $I_1$ if $i = q$.

Having obtained the side on which the dominant term lies, we can then apply the collinear case to determine exactly what term dominates. 

Let this side be $l_R$. Since all the terms on $l_R$ are collinear, 
$$\arg(c_{R (i+1)} - c_{R i}) = \arg(c_{R (j+1)} - c_{R j}) = \alpha_R,$$
for any $i,j = 1,2,\dots, h_R$. 

Therefore, we can simply calculate $\alpha_R = \arg(c_{R (i+1)} - c_{R i})$ with any $i = 1,2,\dots, h_R - 1.$

If $-\frac{\pi}{2} -\alpha_R < \theta < \frac{\pi}{2} - \alpha_R$, then $c_{R 1}$ dominates. Otherwise, $c{R h_R}$ dominates. 

\section{Equivalence}\label{sec:eq}
Recall that the conclusion from the geometric method (in issue \#28) is that for any two terms $e^{iz}$ and $e^{jz}$, given that 
$$\overline{a_i} = p_i (\cos\alpha_i + i\sin\alpha_i),$$
$$z = b (\cos\beta_i + i\sin\beta_i),$$
if $p_i\cos(\alpha_i -\beta) > p_j\cos(\alpha_j -\beta)$, then $e^{a_iz}>e^{a_jz}$. 

Now, we use the ratio method (in issue \# 40) with the same notations:
$$\overline{a_i} = p_i (\cos\alpha_i + i\sin\alpha_i),$$
$$z = b (\cos\beta_i + i\sin\beta_i).$$

It then follows that
\begin{align}
a_i &= p_i (\cos\alpha_i - i\sin\alpha_i)\\
\implies a_i z &= p_i (\cos\alpha_i - i\sin\alpha_i)b (\cos\beta_i + i\sin\beta_i) \\
&=p_i b (\cos\alpha_i\cos\beta + \sin\alpha_i\sin\beta) + i p_i b(\dots))\\
&\approx p_i b \cos(\alpha_i -\beta).
\end{align}
Note that the imaginary part is omitted in (3) because its reletive importance is negligible compared to the real part. 

Thus, the ratio (that we have been using to determine the relative importance of terms) is:
\begin{align*}
	R &= \abs{\frac{e_{a_i z}}{a_j z}}\\
	&= \abs{e^{(a_i-a_j)z}}\\
	&= \abs{e^{b(p_i\cos(\alpha_i-\beta)-p_j\cos(\alpha_j-\beta))}}.
\end{align*}

Therefore, given the conclusion we have obtained in the ratio method, when $p_i\cos(\alpha_i-\beta)>p_j\cos(\alpha_j-\beta)$, $e^{a_iz}>e^{a_jz}$, which is the same as the conclusion of the geometric method. With that, we have shown that the two methods are indeed equivalent. 
\end{document}
